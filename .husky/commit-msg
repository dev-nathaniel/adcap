#!/usr/bin/env bash
set -e

COMMIT_REGEX='^[A-Z0-9]+-[0-9]+ .+'

# Commit message being created
COMMIT_MSG_FILE=$(git rev-parse --git-dir)/COMMIT_EDITMSG
if [ -f "$COMMIT_MSG_FILE" ]; then
  COMMIT_MSG=$(head -n1 "$COMMIT_MSG_FILE")

#   echo "ğŸ” Checking commit message..."
  if ! [[ "$COMMIT_MSG" =~ $COMMIT_REGEX ]]; then
    echo "âŒ Invalid commit message: $COMMIT_MSG"
    echo "ğŸ‘‰ Must match: ABC-123 some message (prefix can be uppercase alphanumeric)"
    exit 1
  fi
#   echo "âœ… Commit message OK: $COMMIT_MSG"
fi
